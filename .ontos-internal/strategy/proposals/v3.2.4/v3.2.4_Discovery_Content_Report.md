# v3.2.4 Discovery: Library Interoperability & Automated Maintenance — Content Report

**Date:** 2026-02-10
**Analyst:** Content Analyst (Gemini 2.5 Pro)
**Scope:** 593 Markdown files in `.ontos-internal/` and `docs/`

---

## 1. Library Census

The Ontos library is substantial but fragmented. A significant portion of the library (~39%) lacks the metadata required for the knowledge graph.

### Quantitative Overview
- **Total Markdown Files:** 593
- **Files with Frontmatter:** 363 (61%)
- **Files WITHOUT Frontmatter:** 230 (39%)
- **Malformed Frontmatter:** 0 (YAML parsing is robust)

### Document Types
Of the 363 files with frontmatter, the type distribution is:
- **`log`**: 117 (32%) — High volume, expected.
- **`strategy`**: 114 (31%) — Very high strategy density.
- **`atom`**: 90 (25%)
- **`review`**: 12 (3%)
- **`kernel`**: 9 (2%)
- **`decision`**: 6
- **`reference`**: 4
- **`spec`**: 2
- **`unknown/other`**: 9

### Field Inventory & Consistency
(Based on 363 tagged files)

| Field | Count | % Coverage | Notes |
|-------|-------|------------|-------|
| `id` | 359 | 99% | Critical identifier. |
| `type` | 358 | 99% | Critical classifier. |
| `status` | 358 | 99% | Good discipline. |
| `concepts` | 285 | 79% | High usage. |
| `depends_on` | 241 | 66% | Primary graph edge. |
| `impacts` | 100 | 28% | Used mostly in logs. |
| `event_type` | 117 | 32% | Used exclusively in logs. |
| `branch` | 47 | 13% | Log attribution. |
| `source` | 46 | 13% | Log attribution. |
| `aliases` | 0 | 0% | **Completely absent from content.** |

### Concept Density
- **Average concepts per doc:** 2.7
- **Max concepts:** 8
- **Excessive (>10) concepts:** 0
- **Finding:** The proposal's `--lint-fix` mode to "prune excessive concepts" solves a non-existent problem. The users are disciplined here.

---

## 2. Link & Reference Health

The graph integrity is degraded, primarily due to "orphaned" documents that exist in the filesystem but are disconnected from the graph.

### The Numbers
- **Total `depends_on` edges:** 301
- **Broken links:** 48 (16% failure rate)
- **Total `impacts` edges:** 118
- **Broken impacts:** 13 (11% failure rate)
- **Orphaned Documents:** 237 (40% of library)

### Broken Link Examples (Dangling Pointers)
These active documents point to IDs that do not exist:
1. `v3_2_chief_architect_response` → `v3_2_spec_review_consolidation` (Missing)
2. `v3_2_final_approval_chief_architect` → `v3_2_code_verification_codex` (Missing)
3. `claude_v2_9_implementation_review_v3` → `v2_9_implementation_plan` (Likely renamed or moved)
4. `v2_9_4_implementation_plan_review_gemini` → `v2_9_implementation_plan`

### Orphan Analysis
The 237 orphans include critical documentation:
- `ontos_context_map` (The map itself!)
- `ontos_changelog`
- `ontos_technical_architecture_map_codex`
- Most `archive/logs/*` are orphans (expected if `impacts` references them, but `depends_on` usually doesn't).

### Link Formats
- **Standard Markdown:** 100% of body links.
- **Wikilinks `[[...]]`:** 0% usage in content. Found only in reference documentation *describing* the feature.
- **Bare IDs:** Used exclusively in `depends_on` / `impacts`.

---

## 3. Obsidian Compatibility Gap Analysis

The proposal's `--obsidian` mode is a **greenfield migration**, not a retrofit. The library currently has **zero** Obsidian optimization.

### Gap Assessment
- **Aliases:** 0 documents have `aliases`.
- **Tags:** 0 documents use `#tag` syntax for categorization (grep matches were only comments/code).
- **Wikilinks:** 0 documents use `[[wikilinks]]`.

### Implication
`ontos retrofit --obsidian` will not be "fixing" broken Obsidian links; it will be **rewriting the entire library's linking structure**.
- **Risk:** High. Converting standard markdown links `[Title](path.md)` to wikilinks `[[ID]]` requires perfect ID-to-Path resolution. Given the 48 broken links, this conversion *will* fail or produce broken wikilinks for 16% of edges.

---

## 4. Maintenance Pain Points (Reality vs. Proposal)

### 1. The "Untagged" Iceberg
39% of the library (230 files) has no frontmatter. These files are invisible to the graph.
- **Proposal Miss:** `retrofit` assumes files have frontmatter to standardize. It does not address the 230 files that need `ontos init --scaffold` (or equivalent).

### 2. Broken Reference Chains
48 broken links mean the graph is disconnected at key strategic points (e.g., v3.2 approvals pointing to missing verification docs).
- **Proposal Hit:** `link-check` is **essential**. It identifies these 48 specific failures.

### 3. "Concepts" are NOT the problem
The proposal suggests auto-pruning excessive concepts.
- **Reality:** Max concept count is 8. This feature fixes nothing.

### 4. Field Ordering is Chaos
We detected **27 distinct field orderings** across 363 files.
- **Proposal Hit:** `retrofit --standardize` is highly relevant. The lack of consistency makes manual reading/editing of frontmatter cognitive load heavy.

---

## 5. Priority Assessment

| Question | Answer |
|----------|--------|
| **Biggest Problem?** | **Graph Disconnection.** 40% orphans + 16% broken links means the "Knowledge Graph" is barely a graph. |
| **Does `retrofit` fix it?** | **No.** `retrofit` polishes existing metadata. It does not fix broken links or tag untagged files. |
| **What does it miss?** | **Scaffolding.** The 230 untagged files need to be brought into the fold. |
| **One automated fix?** | **`ontos link-check` (Diagnostic) -> `ontos fix-links` (Action).** We need to find *where* those broken links go (renamed? deleted?) and patch them. |
| **Is `link-check` justified?** | **YES.** 48 broken links across critical strategy docs is a red alert. Manual inspection is impossible at this scale. |

---

## 6. Recommendations

### 1. Descope `--lint-fix` (Concept Pruning)
Data shows this is unnecessary (max 8 concepts). Don't build code for a non-existent problem.

### 2. Promote `link-check` to P0
The library's referential integrity is compromised (48 broken links). This tool provides immediate value.

### 3. Refine `retrofit --obsidian`
Since usage is currently 0%, this command is a **Mass Migration**.
- **Constraint:** Ensure it can be run *incrementally* or *dry-run* first. Converting 593 files at once is high risk.
- **Requirement:** Must handle the 48 broken links gracefully (don't generate `[[None]]`).

### 4. New "Quick Win": `ontos census` or `ontos status`
Users need visibility into the "39% untagged" statistic. A simple command showing graph coverage would drive adoption of `ontos scaffold`.

### 5. `ontos rename` is High Value
The presence of broken links like `claude_v2_9...` -> `v2_9_implementation_plan` suggests documents are being renamed/moved without updating references. An atomic rename command would prevent future broken links.
