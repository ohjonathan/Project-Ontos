---
id: v3_0_2_hybrid_review_consolidation
type: atom
status: complete
depends_on: [v3.0.2_Hybrid_Review_Peer_Gemini, v3.0.2_Hybrid_Review_Alignment_Claude, v3.0.2_Hybrid_Review_Adversarial_Codex]
concepts: [review-consolidation, decision-document, release-readiness]
---

# v3.0.2 Hybrid Review Consolidation

**Version:** 1.0  
**Date:** 2026-01-18  
**Role:** Consolidator  
**Phase:** B+D Hybrid ‚Äî Consolidation

---

## 1. Verdict Summary

| Reviewer | Role | Verdict | Blocking Issues |
|----------|------|---------|-----------------|
| Gemini | Peer | **REQUEST REVISION** | 2 |
| Claude | Alignment | **REQUEST CHANGES** | 1 |
| Codex | Adversarial | **REQUEST CHANGES** | 1 |

**Consensus:** 0/3 Approve  
**Overall:** ‚ùå **Needs Revision**

---

## 2. "Already Fixed" Claims ‚Äî Consolidated Verdict

The CA claimed 4 issues need no action. What did reviewers find?

| Claim | Gemini Verified? | Claude Verified? | Codex Attacked? | Final Verdict |
|-------|------------------|------------------|-----------------|---------------|
| Init uses native map_command | ‚ùå **FALSE** ‚Äî uses subprocess lines 135-141 | ‚úÖ Verified ‚Äî uses `from ontos.commands.map import map_command` | N/A | ‚ö†Ô∏è **DISPUTED** |
| Map command works | ‚ùå **FALSE** ‚Äî subprocess lines 249-253 | ‚úÖ Verified ‚Äî `_cmd_map()` calls native | N/A | ‚ö†Ô∏è **DISPUTED** |
| Common_Concepts resolved | ‚úÖ Verified | ‚úÖ Confirmed | N/A | ‚úÖ **Confirmed** |
| Uninstall docs correct | ‚úÖ Verified | ‚úÖ Confirmed | N/A | ‚úÖ **Confirmed** |

### Critical Disagreement: Init/Map Implementation

> [!CAUTION]
> **Gemini and Claude provide contradictory code evidence for the same files.**  
> - Gemini cites `init.py:135` with `subprocess.call([sys.executable, "-m", "ontos", "map"])`  
> - Claude cites `init.py:104-145` with `from ontos.commands.map import map_command, MapOptions`
>
> **Resolution Required:** CA must provide current line-numbered code snapshots to resolve which version is deployed. This is a **factual dispute** that blocks release.

**Action Required:** Manual code inspection to determine which review correctly reflects the codebase state.

---

## 3. Blocking Issues

Issues that must be resolved before release:

| # | Issue | Flagged By | Category | Resolution Required |
|---|-------|------------|----------|---------------------|
| **B1** | Init/Map code state disputed | Gemini + Claude | **Factual Conflict** | Provide current code evidence to determine if native or subprocess |
| **B2** | `.ontos.toml` settings ignored by legacy scripts | Claude | Bug Log Gap | Acknowledge: fix, defer, or document as known issue |
| **B3** | `sys.path.insert(0, ...)` shadows package `ontos` | Codex | Runtime Regression | Proposed fix causes `ModuleNotFoundError: ontos.core` ‚Äî commands fail |

---

## 4. Non-Blocking Issues

Issues to consider but not blocking:

| # | Issue | Flagged By | Priority | Recommendation |
|---|-------|------------|----------|----------------|
| NB1 | Deferred commands lack sufficient rationale | Claude | Should | Replace "import structure issue" with specific technical reason |
| NB2 | No workarounds documented | Claude | Should | Add workaround section (shim files documented in bug log) |
| NB3 | Scope change (6‚Üí4 files) lacks paper trail | Claude | Could | Add note explaining already-implemented changes |
| NB4 | `sys.path` guard uses string equality | Codex | Could | Normalize with `resolve()` to handle symlinks |
| NB5 | Fix addresses `ontos_config_defaults` but runtime errors in `ontos.core` | Codex | Should | Verify fix actually addresses the failure mode |

---

## 5. Bug Log Coverage Assessment

Did the spec adequately address the bug log?

| Bug Log Issue | Line(s) | Addressed? | Reviewers Agree? |
|---------------|---------|------------|------------------|
| Init ModuleNotFoundError | 80-81 | CA: "Implicitly fixed" | ‚ö†Ô∏è Disputed |
| Map ModuleNotFoundError | 92-93 | CA: "WORKS NOW" | ‚ö†Ô∏è Disputed |
| Context map returns code 1 | 107-109 | ‚úÖ Native command | ‚úÖ All agree |
| `.ontos.toml` ignored | 499-503 | ‚ùå **NOT ADDRESSED** | ‚úÖ Claude flagged |
| Shim workaround needed | 297-306 | N/A (user mitigation) | ‚úÖ All agree |

**Gaps Identified:**
1. `.ontos.toml` settings being ignored is **not mentioned** in spec (not fixed, not deferred, not known issue)
2. The "already fixed" claims for init/map are disputed between reviewers

---

## 6. Risk Assessment Override

| Source | Risk Level |
|--------|------------|
| CA Spec | LOW |
| Gemini | HIGH (implicit ‚Äî claims fixes are false) |
| Claude | MEDIUM (1 critical gap, otherwise aligned) |
| Codex | **HIGH** (fix introduces runtime regression) |

**Consolidated Risk:** üî¥ **HIGH**

**Reasoning:**
1. Codex demonstrated that the proposed `sys.path.insert(0, ...)` fix **causes** `ModuleNotFoundError: ontos.core` by shadowing the `ontos` package with `ontos/_scripts/ontos.py`
2. Gemini disputes the foundational "already fixed" claims
3. Claude identifies a user-experienced issue completely missing from the spec

---

## 7. Reviewer Disagreements

| Topic | Gemini Says | Claude Says | Codex Says | Resolution |
|-------|-------------|-------------|------------|------------|
| **Init/Map native?** | ‚ùå Uses subprocess (lines 135, 249) | ‚úÖ Native (lines 104, 240) | N/A | **Must resolve** ‚Äî check current code |
| **Risk Level** | HIGH (implicit) | MEDIUM | HIGH | Consolidate to **HIGH** |
| **Scope appropriateness** | Needs expansion | Needs clarification | Scope is arbitrary | All agree spec is insufficient |

---

## 8. Required Actions for Chief Architect

| Priority | Action | Addresses |
|----------|--------|-----------|
| **1** | **Resolve code conflict**: Provide line-numbered code evidence for `init.py` and `cli.py` to determine if native or subprocess | B1 |
| **2** | **Address `.ontos.toml` ignored**: Either fix, defer with rationale, or document as known issue with workaround | B2 |
| **3** | **Fix the fix**: The proposed `sys.path.insert(0, ...)` shadows `ontos` package ‚Äî revise approach (e.g., insert after package root, or use explicit imports) | B3 |
| **4** | Clarify deferral rationale for `verify`/`query`/`consolidate` | NB1 |
| **5** | Document workaround (shim files) for broken commands | NB2 |

---

## 9. Decision Summary

**Spec Status:** ‚ùå **Revision Required**

**Reasons:**
1. **Factual dispute** ‚Äî Two reviewers provide contradictory evidence for the same code. Cannot approve without resolution.
2. **Missing bug log item** ‚Äî `.ontos.toml` ignored is a documented user issue with no spec response.
3. **Fix breaks commands** ‚Äî Adversarial testing shows the proposed fix introduces new runtime failures.

**Before Re-Review:**
- [ ] Resolve init/map code state (native vs subprocess)
- [ ] Address `.ontos.toml` issue explicitly
- [ ] Revise `sys.path.insert` approach to avoid package shadowing
- [ ] Add workaround documentation
- [ ] Clarify deferral rationale

---

## 10. Verification Checklist

Before proceeding to implementation/release:

- [ ] All blocking issues resolved
- [ ] "Already fixed" claims verified by at least 2 reviewers
- [ ] Bug log issues either fixed or explicitly documented as known issues
- [ ] Deferred items have clear rationale
- [ ] Risk level agreed upon
- [ ] Runtime execution tested (not just `--help` / `py_compile`)

---

## Appendix: Evidence Summary

### A1: Gemini's Subprocess Evidence
```python
# init.py:135 (per Gemini)
print("Generating initial context map...")
subprocess.call([sys.executable, "-m", "ontos", "map"])

# cli.py:249 (per Gemini)
return subprocess.call([sys.executable, "-m", "ontos._scripts.ontos_generate_context_map"] + pass_args)
```

### A2: Claude's Native Evidence
```python
# init.py:104-145 (per Claude)
from ontos.commands.map import map_command, MapOptions
# ... native implementation

# cli.py:240-251 (per Claude)
from ontos.commands.map import map_command, MapOptions
options = MapOptions(...)
return map_command(options)
```

### A3: Codex's Runtime Failure Evidence
```
$ python3 -m ontos scaffold
ModuleNotFoundError: No module named 'ontos.core'; 'ontos' is not a package

# Root cause: ontos/_scripts/ontos.py shadows package after sys.path.insert(0, ...)
```

---

*End of Consolidation*
