---
id: v2_6_proposals_and_tooling
type: strategy
status: draft
depends_on: [v2_strategy, s3_archive_implementation_plan]
concepts: [architecture, ontology, proposals, workflow, tooling]
---

# V2.6 Proposal: Proposals Workflow & Rejection History

**Date:** 2025-12-17
**Author:** Claude Opus 4.5 (Architect)
**Status:** Draft - Awaiting Multi-Model Review
**Branch:** v2.5.1 (will become v2.6 after approval)

---

## 1. Executive Summary

This proposal extends Ontos v2.5 with:
1. **Proposals Workflow** - Formalized lifecycle for draft strategy documents
2. **Rejection History** - Recording rejected proposals in decision_history.md
3. **New `status: rejected`** - Completing the document lifecycle
4. **Tooling** - Scripts for proposal creation, approval, and rejection

**Companion feature:** S3 Archive Integration (separate proposal, same release)

---

## 2. Problem Statement

### 2.1 Current State

- Draft documents exist but lack formal lifecycle
- Rejected ideas are lost (no institutional memory)
- No tooling for proposal management
- `status` field underutilized (only `active` commonly used)

### 2.2 User Stories

**As an architect:**
- I want to record why proposals were rejected so we don't re-analyze the same ideas
- I want a clear workflow for moving proposals through review

**As a developer:**
- I want to check if something was already proposed and rejected before starting work
- I want to understand the context behind past rejections

**As an AI agent:**
- I want to know which proposals are pending review
- I want to avoid proposing ideas that were previously rejected without new context

---

## 3. Design Decisions

### 3.1 Ontological Foundation

Proposals fit within the existing dual ontology:

| Ontology | Documents | Temporal State |
|----------|-----------|----------------|
| **Space (Truth)** | kernel, strategy, product, atom | Present |
| **Time (History)** | logs | Past |

**Proposals = Space with `status: draft`** (potential future truth)

This is NOT a new ontological category - it's activating an underused part of the existing schema.

### 3.2 Status Field Extension

| Status | Meaning | When Used |
|--------|---------|-----------|
| `draft` | Work in progress | Proposals under development |
| `active` | Current truth | Approved documents |
| `deprecated` | Past truth | Superseded documents |
| **`rejected`** | Never became truth | Proposals not approved |

### 3.3 Directory Structure

```
.ontos-internal/
├── strategy/
│   ├── v2_strategy.md           # status: active
│   ├── decision_history.md      # status: active
│   └── proposals/               # status: draft
│       ├── v2.6_proposals_and_tooling.md
│       └── s3-archive-*.md
└── archive/
    └── proposals/               # status: rejected (NEW)
        └── rejected_proposal.md
```

### 3.4 Decision History Format

**Current format:**
```markdown
| Date | Slug | Summary | Archive Path |
```

**Proposed format:**
```markdown
| Date | Slug | Decision | Outcome | Archive Path |
|------|------|----------|---------|--------------|
| 2025-12-10 | auth-flow | OAuth2 implementation | APPROVED | archive/logs/... |
| 2025-12-17 | redis-cache | Redis caching layer | REJECTED: complexity | archive/proposals/... |
```

### 3.5 Rejection Metadata

When a proposal is rejected, add to frontmatter:

```yaml
---
id: redis_cache_proposal
type: strategy
status: rejected
rejected_date: 2025-12-17
rejected_reason: "Too complex for current scale; revisit at 10k users"
rejected_by: "Claude Opus 4.5"
depends_on: [v2_strategy]
---
```

---

## 4. Proposal Lifecycle

```
┌─────────────────────────────────────────────────────────────────┐
│                        PROPOSAL LIFECYCLE                        │
└─────────────────────────────────────────────────────────────────┘

                         ┌─────────────┐
                         │   CREATE    │
                         │status: draft│
                         │ proposals/  │
                         └──────┬──────┘
                                │
                         ┌──────▼──────┐
                         │   REVIEW    │
                         │(multi-model)│
                         └──────┬──────┘
                                │
                 ┌──────────────┴──────────────┐
                 ▼                              ▼
        ┌────────────────┐            ┌────────────────┐
        │    APPROVE     │            │    REJECT      │
        │ status: active │            │status: rejected│
        └────────┬───────┘            └────────┬───────┘
                 │                              │
        ┌────────▼───────┐            ┌────────▼───────┐
        │  Stay in place │            │    Move to     │
        │   or promote   │            │archive/proposals│
        └────────┬───────┘            └────────┬───────┘
                 │                              │
                 └──────────────┬──────────────┘
                                │
                         ┌──────▼──────┐
                         │  Record in  │
                         │decision_hist│
                         └─────────────┘
```

---

## 5. Deliverables

### 5.1 Schema Changes

**File:** `.ontos-internal/atom/schema.md`

Add `rejected` to valid status values:
```yaml
status:
  type: string
  enum: [draft, active, deprecated, rejected]
  description: |
    - draft: Work in progress (proposals)
    - active: Current truth (approved)
    - deprecated: Past truth (superseded)
    - rejected: Never became truth (rejected proposals)
```

### 5.2 Context Map Updates

**File:** `.ontos/scripts/ontos_generate_context_map.py`

**5.2.1 Status Indicator**
Show `[draft]` or `[rejected]` after document names:
```markdown
### STRATEGY
- **v2_strategy** (v2_strategy.md) ~2,600 tokens
- **s3_archive_analysis** (s3-archive-analysis.md) ~4,000 tokens [draft]
```

**5.2.2 Optional Proposals Section**
With `--show-proposals` flag:
```markdown
### PROPOSALS (Draft)
- **s3_archive_analysis** (s3-archive-analysis.md) ~4,000 tokens
- **v2_6_proposals_and_tooling** (v2.6_proposals_and_tooling.md) ~8,000 tokens
```

**5.2.3 Skip Orphan Check for Drafts**
Drafts are naturally orphans (nothing depends on them yet).

### 5.3 Lint Warnings

**File:** `.ontos/scripts/ontos_generate_context_map.py` (lint section)

**5.3.1 Stale Proposal Warning**
```python
PROPOSAL_STALE_DAYS = 60  # Configurable

if doc['status'] == 'draft' and doc['age_days'] > PROPOSAL_STALE_DAYS:
    warnings.append(f"[STALE PROPOSAL] {doc['id']} is draft for {doc['age_days']} days")
```

Output:
```
[STALE PROPOSAL] s3_archive_analysis is draft for 65 days
  Action: Approve, reject, or update
```

### 5.4 New Script: `ontos_create_proposal.py`

```python
"""Create a new proposal document in strategy/proposals/."""

def main():
    parser = argparse.ArgumentParser(description='Create a proposal')
    parser.add_argument('--title', '-t', required=True, help='Proposal title')
    parser.add_argument('--id', '-i', help='Document ID (auto-generated if not provided)')
    parser.add_argument('--depends-on', '-d', nargs='*', default=['v2_strategy'])
    parser.add_argument('--concepts', '-c', nargs='*', default=[])

    # Generate template with frontmatter
    # Create in strategy/proposals/
    # Open in editor (optional)
```

**Usage:**
```bash
python3 .ontos/scripts/ontos_create_proposal.py -t "Redis Caching Layer" -c caching performance
```

### 5.5 New Script: `ontos_approve_proposal.py`

```python
"""Approve a proposal: change status to active, optionally move, record in decision_history."""

def main():
    parser = argparse.ArgumentParser(description='Approve a proposal')
    parser.add_argument('proposal_id', help='Proposal document ID')
    parser.add_argument('--promote', action='store_true', help='Move out of proposals/ to strategy/')
    parser.add_argument('--summary', '-s', help='Decision summary for history')

    # Change status: draft → active
    # Optionally move file
    # Append to decision_history.md with APPROVED outcome
```

**Usage:**
```bash
python3 .ontos/scripts/ontos_approve_proposal.py s3_archive_analysis --summary "Approved Option A"
```

### 5.6 New Script: `ontos_reject_proposal.py`

```python
"""Reject a proposal: add rejection metadata, move to archive, record in decision_history."""

def main():
    parser = argparse.ArgumentParser(description='Reject a proposal')
    parser.add_argument('proposal_id', help='Proposal document ID')
    parser.add_argument('--reason', '-r', required=True, help='Rejection reason')
    parser.add_argument('--revisit', help='Conditions under which to revisit')

    # Add rejection metadata to frontmatter:
    #   status: rejected
    #   rejected_date: <today>
    #   rejected_reason: <reason>
    #   rejected_by: <from config or prompt>
    # Move to archive/proposals/
    # Append to decision_history.md with REJECTED outcome
```

**Usage:**
```bash
python3 .ontos/scripts/ontos_reject_proposal.py redis_cache -r "Too complex for current scale" --revisit "10k users"
```

### 5.7 Integration with `ontos_end_session.py`

Add `--proposal` flag to create a proposal instead of a log:

```bash
# Current: creates a log
python3 .ontos/scripts/ontos_end_session.py -e exploration -s "Claude"

# New: creates a proposal
python3 .ontos/scripts/ontos_end_session.py --proposal -t "Redis Caching" -s "Claude"
```

### 5.8 Agent Instructions Updates

**File:** `docs/reference/Ontos_Agent_Instructions.md`

Add section:
```markdown
### Proposal Awareness

1. **Before starting exploration:** Check `strategy/proposals/` for relevant pending proposals
2. **After significant exploration:** Consider creating a proposal if findings warrant review
3. **When approving/rejecting:** Use tooling to maintain decision_history.md
4. **Check rejection history:** Before proposing something new, search decision_history for prior rejections
```

### 5.9 Manual Updates

**File:** `docs/reference/Ontos_Manual.md`

Add section:
```markdown
## Proposals Workflow

### When to Create a Proposal
- Multi-session planning (too complex for single log)
- Options analysis requiring architectural review
- Implementation plans before coding begins

### Proposal vs Log

| Scenario | Document Type |
|----------|---------------|
| "What happened today" | Log |
| "What we might do" | Proposal |
| "Analysis of options" | Proposal |
| "Decision made in session" | Log (event_type: decision) |

### Proposal Lifecycle
1. **Create:** `python3 .ontos/scripts/ontos_create_proposal.py -t "Title"`
2. **Review:** Share with other models/architects
3. **Decide:**
   - Approve: `python3 .ontos/scripts/ontos_approve_proposal.py <id>`
   - Reject: `python3 .ontos/scripts/ontos_reject_proposal.py <id> -r "reason"`

### Rejection History
Rejected proposals are preserved in `archive/proposals/` and recorded in `decision_history.md`. This prevents re-analyzing rejected ideas without context.
```

### 5.10 Common Concepts Updates

**File:** `docs/reference/Common_Concepts.md`

Add:
```markdown
| `proposal` | Draft strategy document awaiting approval |
| `rejection` | Record of a proposal that was not approved |
```

---

## 6. File Changes Summary

| File | Change Type | Description |
|------|-------------|-------------|
| `.ontos-internal/atom/schema.md` | Modify | Add `rejected` status |
| `.ontos/scripts/ontos_generate_context_map.py` | Modify | Status indicators, proposals section, lint |
| `.ontos/scripts/ontos_create_proposal.py` | New | Proposal creation |
| `.ontos/scripts/ontos_approve_proposal.py` | New | Proposal approval |
| `.ontos/scripts/ontos_reject_proposal.py` | New | Proposal rejection |
| `.ontos/scripts/ontos_end_session.py` | Modify | Add `--proposal` flag |
| `docs/reference/Ontos_Agent_Instructions.md` | Modify | Proposal awareness |
| `docs/reference/Ontos_Manual.md` | Modify | Proposals workflow section |
| `docs/reference/Common_Concepts.md` | Modify | Add proposal, rejection concepts |
| `.ontos-internal/strategy/decision_history.md` | Modify | Add Outcome column |

---

## 7. Testing Plan

### 7.1 Unit Tests

| ID | Test | Expected |
|----|------|----------|
| T1 | Create proposal with valid frontmatter | File created in proposals/ |
| T2 | Create proposal with missing title | Error: title required |
| T3 | Approve proposal | Status changes to active, recorded in history |
| T4 | Approve with --promote | File moves out of proposals/ |
| T5 | Reject proposal | Status=rejected, metadata added, moved to archive |
| T6 | Reject without reason | Error: reason required |
| T7 | Context map shows [draft] | Drafts have indicator |
| T8 | Context map --show-proposals | Separate section appears |
| T9 | Lint detects stale proposal | Warning after 60 days |
| T10 | Orphan check skips drafts | No orphan warning for proposals |

### 7.2 Integration Tests

| ID | Test | Expected |
|----|------|----------|
| T11 | Full lifecycle: create → approve | Ends in strategy/ with history entry |
| T12 | Full lifecycle: create → reject | Ends in archive/proposals/ with history entry |
| T13 | ontos_end_session --proposal | Creates proposal, not log |

---

## 8. Migration

### 8.1 Existing Documents

No migration needed - existing documents continue to work.

### 8.2 decision_history.md Format

Existing entries remain valid. New entries use expanded format:
```markdown
<!-- Old format (still valid) -->
| 2025-12-10 | auth-flow | Chose OAuth2 | archive/logs/... |

<!-- New format -->
| 2025-12-10 | auth-flow | Chose OAuth2 | APPROVED | archive/logs/... |
```

Backward compatible: scripts handle both formats.

---

## 9. Risks and Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| Proposals accumulate without review | Context bloat | Stale proposal lint warning |
| Rejection reason too brief | Lost context | Require minimum length or template |
| Tooling complexity | Adoption friction | Make tooling optional; manual workflow documented |
| Status confusion | Misclassified docs | Clear documentation, validation |

---

## 10. Contributor-Mode: Version Release Workflow

**Scope:** Internal Project Ontos development only (not user-facing)

### 10.1 Problem

When shipping new Ontos versions (v2.5.1, v2.5.2, etc.), there's no reminder to:
1. Update `Ontos_CHANGELOG.md` with release notes
2. Bump `ONTOS_VERSION` in `ontos_config_defaults.py`

Session archival creates logs but doesn't touch the tooling changelog. This led to v2.5.1 and v2.5.2 being shipped without changelog entries.

### 10.2 Solution: Pre-push Version Check (Contributor Mode Only)

**Trigger:** When `.ontos/scripts/` files are modified but `ONTOS_VERSION` hasn't changed

**Location:** `ontos_pre_push_check.py` (contributor mode branch)

```python
def check_version_bump_needed() -> bool:
    """Check if .ontos/scripts/ changes warrant a version bump.

    Only runs in contributor mode (Project Ontos repo itself).
    """
    if not is_ontos_repo():
        return True  # Skip for users

    # Get files changed since last push
    changed_files = get_staged_or_committed_files()

    # Check if any .ontos/scripts/ files were modified
    scripts_changed = any(f.startswith('.ontos/scripts/') for f in changed_files)

    if not scripts_changed:
        return True  # No scripts changed, no warning needed

    # Check if ONTOS_VERSION was bumped
    version_file = '.ontos/scripts/ontos_config_defaults.py'
    if version_file not in changed_files:
        print("⚠️  CONTRIBUTOR REMINDER: .ontos/scripts/ modified but ONTOS_VERSION unchanged.")
        print("   If shipping a new version, update:")
        print("   1. ONTOS_VERSION in ontos_config_defaults.py")
        print("   2. Ontos_CHANGELOG.md with release notes")
        print("")
        print("   Skip this check with: git push --no-verify")
        return False  # Block (advisory in first iteration)

    return True
```

### 10.3 Optional: `ontos_release.py` Script

For explicit version releases:

```bash
python3 .ontos/scripts/ontos_release.py 2.5.2 --theme "Dual-Mode Remediation"
```

**Actions:**
1. Bump `ONTOS_VERSION` in `ontos_config_defaults.py`
2. Add changelog entry header to `Ontos_CHANGELOG.md`
3. Prompt for changelog categories (Added/Changed/Fixed)
4. Create git tag `v2.5.2`
5. Open changelog in editor for manual additions

**Implementation Complexity:** Medium - nice-to-have, not blocking

### 10.4 Deliverables

| Priority | Deliverable | Description |
|----------|-------------|-------------|
| P0 | Pre-push version check | Warning when scripts change without version bump |
| P1 | `ontos_release.py` | Explicit release workflow script |
| P2 | Changelog entry helper | Interactive changelog entry for `Ontos_CHANGELOG.md` |

### 10.5 Why Contributor-Mode Only

Users of Ontos don't release Ontos versions - they use Ontos to manage their own projects. This workflow is purely for maintainers working on Project Ontos itself.

---

## 11. Future Considerations (v2.7+)

1. **Proposal voting:** Multiple reviewers vote approve/reject
2. **Conditional approval:** "Approved pending X"
3. **Proposal versioning:** Track proposal revisions before approval
4. **Rejection expiry:** Auto-surface old rejections for reconsideration
5. **Proposal templates:** Different templates for different proposal types

---

## 12. Open Questions for Reviewers

### Q1: Rejection Reason Requirements

**Question:** Should rejection reasons have minimum requirements?

| Option | Description |
|--------|-------------|
| A: Free text | Any reason accepted |
| B: Minimum length | At least 50 characters |
| C: Template | Must include: reason, conditions to revisit |

**Architect Recommendation:** Option C - structured rejection ensures useful context

### Q2: Stale Proposal Threshold

**Question:** How long before a proposal is considered stale?

| Option | Threshold |
|--------|-----------|
| A: 30 days | Aggressive |
| B: 60 days | Moderate |
| C: 90 days | Relaxed |
| D: Configurable | User sets threshold |

**Architect Recommendation:** Option D with 60-day default

### Q3: Proposal Section in Context Map

**Question:** Should proposals have their own section by default?

| Option | Behavior |
|--------|----------|
| A: Inline with status indicator | `[draft]` suffix |
| B: Separate section always | `### PROPOSALS` |
| C: Separate section with flag | `--show-proposals` |
| D: Exclude by default | `--include-drafts` to show |

**Architect Recommendation:** Option A default, Option B available via flag

### Q4: Rejection Archive Location

**Question:** Where should rejected proposals live?

| Option | Location |
|--------|----------|
| A: `archive/proposals/` | Parallel to `archive/logs/` |
| B: `strategy/rejected/` | Under strategy |
| C: `archive/rejected/` | Generic rejected folder |

**Architect Recommendation:** Option A - mirrors logs archive pattern

### Q5: Should rejected proposals be included in context map?

**Question:** Are rejected proposals useful context?

| Option | Behavior |
|--------|----------|
| A: Never include | Saves tokens |
| B: Include with `--include-rejected` | Opt-in |
| C: Always include in REJECTED section | Full history |

**Architect Recommendation:** Option B - opt-in for comprehensive recall

---

## 13. Approval Checklist

| Reviewer | Status | Date | Notes |
|----------|--------|------|-------|
| Claude (Architect) | DRAFT | 2025-12-17 | Initial proposal |
| Codex | PENDING | — | — |
| Gemini | PENDING | — | — |
| Human (Jonathan) | PENDING | — | — |

---

## 14. References

- [V2.5 Implementation Plan](.ontos-internal/strategy/v2.5/v2.5_promises_implementation_plan.md)
- [S3 Archive Analysis](s3-archive-analysis.md)
- [S3 Archive Implementation Plan](s3-archive-implementation-plan.md)
- [Session Log: Proposals Architecture](.ontos-internal/logs/2025-12-17_v2-5-1-proposals-architecture.md)
