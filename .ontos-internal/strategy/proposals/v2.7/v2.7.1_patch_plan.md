---
id: v2_7_1_patch_plan
type: strategy
status: complete
depends_on: []
concepts: [patch, fixes, documentation]
---

# v2.7.1 Patch Plan

**Author:** Claude Code (Opus 4.5) as Chief Architect
**Date:** 2025-12-19
**Goal:** Elevate v2.7 from A- to A grade

---

## Executive Summary

v2.7.0 shipped with grade A- (94% of success criteria met). This patch addresses the remaining gaps to reach A grade.

**Scope:** Bug fixes and documentation polish only. No new features.

---

## Grade Criteria

| Grade | Requirements | Status |
|-------|--------------|--------|
| **A-** | Core complete, tests pass, docs updated, self-hosting | ‚úÖ v2.7.0 |
| **A** | + All tests pass (225/225), minor polish | üéØ v2.7.1 target |
| **A+** | + schema.md updates, cookbook examples | Deferred to v2.9 |

---

## v2.7.1 Tasks

### Required for A Grade

#### 1. Fix Pre-existing Test Failure
**Priority:** High
**File:** `tests/test_lint.py`
**Issue:** `test_lint_exceeds_retention_count` references missing `LOG_WARNING_THRESHOLD` config

**Investigation needed:**
```bash
grep -r "LOG_WARNING_THRESHOLD" .
```

**Options:**
1. Add missing config to `ontos_config.py`
2. Remove obsolete test if config was intentionally removed
3. Update test to use correct config name

**Success:** 225/225 tests pass

---

### Recommended Polish (Nice-to-have)

#### 2. Add Exception Logging
**Priority:** Low
**File:** `.ontos/scripts/ontos_end_session.py`

**Current:**
```python
except Exception:
    pass
```

**Proposed:**
```python
except Exception as e:
    import logging
    logging.debug(f"Staleness check skipped: {e}")
```

**Rationale:** Silent failures make debugging harder.

---

#### 3. Update Common_Concepts.md
**Priority:** Low
**File:** `docs/reference/Common_Concepts.md` or `.ontos-internal/reference/Common_Concepts.md`

**Add concepts:**
```markdown
| describes | Documentation relationship tracking (v2.7) |
| staleness | Detection of outdated documentation (v2.7) |
| immutable-history | Generated decision history from logs (v2.7) |
```

---

#### 4. Cookbook Examples in Manual
**Priority:** Low
**File:** `docs/reference/Ontos_Manual.md`

**Add section:**
```markdown
## Documentation Staleness Tracking (v2.7)

Track when documentation becomes stale after code changes.

### Basic Usage
‚Äã```yaml
# In your documentation file
describes:
  - script_name
  - another_script
describes_verified: 2025-12-19
‚Äã```

### When to Use
- README files that document CLI usage
- API documentation that describes endpoints
- Guides that reference specific code files
```

---

#### 5. Warning Format Enhancement
**Priority:** Very Low
**File:** `.ontos/scripts/ontos_end_session.py`

**Current:**
```
‚ö†Ô∏è  2 document(s) may be stale:
   - ontos_manual: describes ontos_end_session (modified after 2025-12-15)
```

**Plan spec:**
```
‚ö†Ô∏è  Documentation may be stale:

   Ontos_Manual.md describes:
     - ontos_end_session (changed 2025-12-18, verified 2025-12-15)

   Run: python3 .ontos/scripts/ontos_verify.py docs/reference/Ontos_Manual.md
```

**Rationale:** Shows both dates for easier decision-making.

---

## Explicitly Deferred to v2.9

| Item | Rationale |
|------|-----------|
| schema.md updates | Part of v2.9 Schema Versioning work |
| Performance benchmarks | Informal tests sufficient; formal benchmarks with v2.8 Context Object |

---

## Implementation Order

1. **Fix test failure** (required for A)
2. Exception logging (5 min)
3. Common_Concepts.md (5 min)
4. Cookbook examples (10 min)
5. Warning format (15 min)

**Estimated total:** ~1 hour

---

## Success Criteria

v2.7.1 is complete when:

1. ‚úÖ 225/225 tests pass (no pre-existing failures)
2. ‚úÖ Exception logging added to staleness check
3. ‚úÖ Common_Concepts.md updated with v2.7 terms
4. ‚úÖ Manual has cookbook examples for describes

**Grade after v2.7.1:** A

---

## Non-Goals

- No new features
- No schema.md changes (v2.9)
- No architectural changes
- No performance optimization

---

*End of v2.7.1 Patch Plan*
