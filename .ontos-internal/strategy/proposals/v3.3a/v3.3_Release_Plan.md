---
id: v3_3_release_plan
type: strategy
status: active
depends_on: [v3_3_merged_audit_findings, v3_2_4_prea_consolidation]
concepts: [v3.3, release-planning, tracks, sequencing, phase-a]
---

# v3.3 Release Plan

## 1) Overview

v3.3 ships **all 62 merged findings plus 3 pre-approved features**:
- Unified scan scope (`--scope docs|library`) across commands
- `ontos link-check`
- `ontos rename <old_id> <new_id>`

Because the scope is large and file overlap is high, this release is organized as **Track B (features)** plus **Track A hardening sub-tracks (A1-A4)**. This keeps each track independently verifiable while minimizing merge churn.

Planning assumptions used:
- No deferrals out of v3.3
- Settled feature decisions are binding (`B1`-`B5`, `S1`, `S3`-`S5`)
- Parallel execution only where there is no file overlap and no shared mutable dependency

Estimated total change volume: **~3.8k-5.4k LOC** including tests/docs.

---

## 2) Track Structure

### Track A1 — Core Contracts & Graph Integrity (Prereq Foundation)

**Items:**
`#1 (CC-03), #8 (C-5), #9 (C-7), #10 (C-8), #25 (C-6), #33 (CC-01), #36 (CC-05), #37 (CC-06), #40 (CC-09), #41 (CC-11), #42 (CC-16), #44 (CC-19)`

**Why grouped:**
- Shared core modules (`core/frontmatter.py`, `io/files.py`, `validation.py`, graph/load paths)
- Resolves parser/loading contract ambiguity before any new feature code
- Contains 4 of the 6 explicit Track B prerequisites (`#1`, `#10`, `#40`, `#42`, `#44`)

**Aggregate effort:** ~0.7k-0.9k LOC

**Dependencies:** none (must land first)

---

### Track B — Features (Unified Scan + Link-Check + Rename)

**Features included:**
1. Unified scan scope (`docs` default, `library` opt-in) across all relevant commands
2. `ontos link-check` with shared body parser, JSON output, and exit codes `0/1/2`
3. `ontos rename <old_id> <new_id>` with dry-run default, `--apply`, atomic commit path, targeted frontmatter updates

**Merged findings absorbed in this track:**
`#11 (C-9), #38 (CC-07)`

**Why grouped:**
- Single shared infrastructure: scanner + body-link parser (`B2`)
- Feature coupling is intentional and already design-approved
- `#38 (CC-07)` is resolved directly by unified scan; `#11 (C-9)` is resolved by replacing maintain-task link loading with shared scanner/reporting path

**Aggregate effort:** ~1.6k-2.2k LOC

**Dependencies:** Track A1

---

### Track A2 — Command Safety & State Integrity (Non-Feature Hardening)

**Items:**
`#12 (C-10), #13 (C-11), #14 (C-13), #15 (C-14), #26 (C-12), #27 (C-15), #28 (C-16), #29 (C-17), #45 (X-H2), #48 (X-M3), #51 (X-M10), #60 (X-M8), #61 (X-M9)`

**Why grouped:**
- Shared fix pattern: transactional safety, path-root correctness, strict input semantics
- Primarily isolated to `consolidate`, `doctor`, `paths`, `migrate`, proposal/history parsing, config parsing
- Minimal overlap with feature files

**Aggregate effort:** ~0.5k-0.7k LOC

**Dependencies:** Track A1

---

### Track A3 — CLI Surface, Output Contracts, and Command Taxonomy

**Items:**
`#2 (G-1), #3 (G-2/C-2/C-3), #6 (C-1), #7 (C-4/G-3), #16 (G-3), #17 (G-4), #18 (G-6), #19 (G-7), #20 (G-8), #21 (G-9/X-M12), #24 (G-14), #34 (CC-02/X-M7), #35 (CC-04), #39 (CC-08), #43 (CC-18), #46 (X-M1), #47 (X-M2), #49 (X-M4), #50 (X-M5), #52 (G-10), #58 (CC-17), #62 (X-M11)`

**Why grouped:**
- Heavy overlap in `cli.py` and command output/error pathways
- Shared contract work: flags, JSON behavior, error classes, return-type normalization, command discoverability
- Includes command-surface consolidation work (`G-9/X-M12`, `X-M11`)

**Aggregate effort:** ~1.1k-1.5k LOC

**Dependencies:** Track B + Track A2 (to avoid rework on command contracts changed in both)

---

### Track A4 — Docs Drift, Dead Code Removal, and Test Coverage

**Items:**
`#4 (G-5), #5 (G-11), #22 (G-12), #23 (G-13), #30 (C-18), #31 (C-19), #32 (C-20), #53 (CC-10), #54 (CC-12), #55 (CC-13), #56 (CC-14), #57 (CC-15), #59 (CC-20)`

**Why grouped:**
- Low-risk cleanup and test hardening
- Documents and dead-code cleanup are independent from feature design decisions
- Test additions are most stable after command contracts settle

**Aggregate effort:** ~0.4k-0.6k LOC

**Dependencies:**
- Docs subset (`#4, #5, #22, #23`) can run anytime after Track B starts
- Tests/dead-code subset should run after Track A3

---

## 3) Dependency Graph (Sequential vs Parallel)

```text
A1 (Core contracts)
  ├──> B  (Features)
  │      └──> A3 (CLI/output/taxonomy)
  └──> A2 (Command safety)

A4a (docs-only subset) can run in parallel with B/A2/A3.
A4b (tests + dead code) runs after A3 for stable assertions.
```

Parallel-safe windows:
- **Window 1:** `B` and `A2` in parallel (after `A1`)
- **Window 2:** `A4a` parallel with any active code track

Not parallel-safe:
- `B` and `A3` (shared `cli.py`, `query.py`, command contracts)
- `A2` and `A3` for final return/output harmonization passes

---

## 4) Track B Spec Readiness (Phase A)

**Assessment:** Ready for Phase A spec writing.

Why it is ready:
- Discovery complete across three independent reports
- Proposal + three reviews + consolidation complete
- Blocking design questions are explicitly settled (`B1`-`B5`, `S1`, `S3`-`S5`)
- Prerequisite risks are mapped into Track A1 and sequencing enforces them

What Phase A spec should still concretize (not new design work):
1. Command-by-command scan migration matrix (`--scope` adoption table)
2. Final JSON schemas/examples for `link-check` and `rename` dry-run/apply
3. Body-parser acceptance corpus (real IDs with dot/underscore/hyphen, code-fence and inline-code cases)
4. Post-rename regeneration warning wording (`ontos map`, `ontos agents`)

---

## 5) Implementation Order Within Tracks

### Track A1 Order
1. Canonical parser/loader contract (`#1`, `#40`, `#41`)
2. Input normalization and duplicate detection (`#25`, `#8`, `#9`, `#10`)
3. Graph/validation contract cleanup (`#36`, `#37`, `#42`, `#44`)
4. Layer boundary cleanup (`#33`)

### Track B Order
1. Unified scan utility + `--scope` wiring across target commands (`#38`, `B4`)
2. Shared markdown body-link parser (zone-aware, tokenization per `B1`, read-only mode per `B2`, dry-run context per `B3`)
3. `ontos link-check` (broken refs + duplicates + orphans, suggestions, JSON, `S1` exit semantics)
4. `ontos rename` (dry-run default, `--apply`, collision checks, targeted FM update `S3`, canonical parser `S4`, post-run warning `S5`)
5. Replace maintain task link check path with shared scanner/parser reporting (`#11`)

### Track A2 Order
1. Root/path correctness (`#15`, `#14`)
2. Consolidate transactional semantics and strict input handling (`#12`, `#13`, `#26`, `#45`)
3. Migration/proposal/history parser fixes (`#27`, `#28`, `#29`, `#48`)
4. Config/template typing and status semantics (`#51`, `#60`, `#61`)

### Track A3 Order
1. Safety-critical correctness first (`#6`, `#7`, `#46`, `#47`, `#50`)
2. JSON/output contract fixes (`#3`, `#20`, `#58`, `#35`, `#43`)
3. Flag and command taxonomy normalization (`#2`, `#16`, `#17`, `#18`, `#19`, `#52`, `#21`, `#62`, `#34`)
4. Error/exception handling and cycle-reporting closure (`#24`, `#39`, `#49`)

### Track A4 Order
1. Documentation drift fixes (`#4`, `#5`, `#22`, `#23`)
2. Dead code and unused-option cleanup (`#53`, `#54`, `#55`, `#56`, `#57`, `#59`)
3. Coverage gaps (`#30`, `#31`, `#32`)

---

## 6) Findings Resolved for Free by Track B

- `#38 (CC-07)` is directly resolved by unified scan scope standardization.
- `#11 (C-9)` is resolved if maintain's link-check task is routed through the shared scanner/parser and parse-failure accounting.

No other findings should be marked "for free" without explicit acceptance tests; this avoids accidental under-delivery.

---

## 7) Delivery Risk Notes

- The largest risk concentration is **Track B + Track A3** due shared command-surface files and output contracts.
- If review bandwidth is limited, prioritize code review depth in this order: `A1 -> B -> A3 -> A2 -> A4`.
- Expected PR strategy: one PR per track/sub-track with strict file-boundary discipline.
