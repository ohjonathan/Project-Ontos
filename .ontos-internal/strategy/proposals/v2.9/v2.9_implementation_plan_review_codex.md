---
id: v2_9_implementation_plan_review_codex
type: atom
status: draft
depends_on: [v2_9_implementation_plan]
concepts: [architecture, security, schema, adoption, release]
---

# Review: v2.9 Implementation Plan (Codex)

**Reviewer:** Codex (GPT-5)
**Date:** 2025-12-22
**Scope:** Critical review of `v2.9_implementation_plan.md`
**Goal:** Provide thorough feedback, improvements, and unaddressed risks for Chief Architect updates.

---

## 1) Executive Summary — Core Findings

1. **Installer trust model is incomplete.** Embedding SHA256 in `install.py` does not protect against a compromised installer. The plan needs a cryptographic trust anchor (signed checksums or similar).
2. **Schema versioning is underspecified.** Inference rules create ambiguity and weaken schema guarantees. Explicit schema contracts are required; inference should be limited to legacy documents.
3. **Curation levels risk diluting validation integrity.** Without clear mode separation, users and agents may treat incomplete docs as fully valid.
4. **Deprecation warnings won’t be seen.** `DeprecationWarning` is ignored by default; the plan assumes visibility that won’t exist.
5. **Upgrade/rollback semantics are unclear.** `--upgrade` must define safety rules, backups, and config merge behavior.

---

## 2) Detailed Feedback & Improvements

### 2.1 Installer Trust Model (Supply Chain)

**Issue:** The checksum strategy protects only if `install.py` is already trusted. A compromised installer can change its own checksum and bundle URL.

**Recommendations:**
- **Add a cryptographic trust anchor:**
  - Sign `checksums.json` (or the bundle) with a maintainer key (GPG or minisign).
  - Embed the public key in `install.py`.
  - Flow: download `checksums.json` + signature → verify → download bundle → verify checksum.
- **Pin installer URLs to tags:** avoid `main` in docs. Prefer `.../raw/v2.9.0/install.py`.
- **Publish installer hash in README/release notes:** optional but useful to verify `install.py` itself.

**Plan Update Suggestion:** Add a “Trust Anchor and Signing” section in Feature 1 with CI steps.

---

### 2.2 Schema Versioning Semantics

**Issue:** Inference-based schema detection blurs version boundaries and reduces predictability. Schema versions must map to explicit field sets and validation rules.

**Recommendations:**
- Define **explicit schema contracts** (e.g., 2.0 = base fields, 2.1 = adds `describes`, 2.2 = adds `curation_level`).
- Restrict inference to **legacy docs without `ontos_schema`**. Post-migration, version is always explicit.
- Document behavior for **future schema versions**: warn + skip strict validation or read-only.
- Add a **schema compatibility matrix** to the manual and reference it in the plan.

**Plan Update Suggestion:** Expand Section 3 with a schema spec appendix and compatibility rules.

---

### 2.3 Curation Levels & Validation Integrity

**Issue:** Level 0/1 introduces partial data but the plan doesn’t define how tooling should interpret “valid.” This risks contaminating dependency graphs and agent context.

**Recommendations:**
- Define validation **modes**:
  - `--strict`: only Level 2 is considered valid; Level 0/1 marked incomplete.
  - `--curated`: accept docs at their declared level.
- Ensure context map **displays curation level** and never treats Level 0/1 as fully verified in default mode.
- Clarify hierarchy enforcement by level:
  - Level 0: hierarchy ignored, flagged “unverified.”
  - Level 1: valid type required; depends_on optional.
  - Level 2: full enforcement.

**Plan Update Suggestion:** Add “validation semantics” to Feature 3 and update success criteria.

---

### 2.4 Deprecation Warning Visibility

**Issue:** `DeprecationWarning` is silenced by default, so most users will never see warnings.

**Recommendations:**
- Use `FutureWarning` or explicitly enable warnings in `ontos.py` with a filter for the Ontos namespace.
- Optionally emit a **CLI notice** once per run for deprecated usage.

**Plan Update Suggestion:** Add a “visibility requirement” under Feature 4 and a test ensuring warnings are visible by default.

---

### 2.5 Upgrade & Rollback Semantics

**Issue:** `--upgrade` behavior is undefined. Installation must be safe, reversible, and preserve user config.

**Recommendations:**
- Create a **backup** of `.ontos/` and `ontos.py` before overwrite.
- If `ontos_init.py` fails, **rollback** automatically.
- Document config handling: never overwrite `ontos_config.py` without user intent; provide a merge strategy or preserve existing config.
- Support `--target` to install into a staging directory.

**Plan Update Suggestion:** Add explicit upgrade and rollback rules to Feature 1.

---

## 3) Missing Possibilities / Unaddressed Risks

### 3.1 Offline / Air-Gapped Install
- Provide `--bundle` and `--checksums` flags for offline use.
- Document manual install path in README.

### 3.2 Windows Portability
- Add PowerShell download instructions.
- Ensure paths and extraction are Windows-safe.

### 3.3 Filesystem Safety
- Guard against extraction into unsafe locations.
- Require explicit `--upgrade` if existing `.ontos/` is detected.

### 3.4 Schema Migration Diff Preservation
- Frontmatter preservation is not addressed. If formatting/order/comments are lost, migrations may be rejected.
- Add a preservation strategy or clear warning in the plan.

### 3.5 Curation Impact on Agents
- Level 0/1 documents must not contaminate “authoritative” context unless explicitly requested.
- Add a warning banner to context map when Level 0/1 docs are present.

### 3.6 Release Integrity in CI
- CI should fail release if checksum placeholders remain.
- Include bundle manifest with version + git SHA.

### 3.7 Realistic Test Coverage
- Add integration tests or a manual release checklist for:
  - no network
  - checksum mismatch
  - readonly directory
  - upgrade failure rollback

---

## 4) Proposed Implementation Plan Additions (Concise)

1. **Installer Security**
   - Add signed checksums (minisign/GPG).
   - Pin installer URLs to tags.
   - Document hash verification for `install.py`.

2. **Schema Contract**
   - Publish schema definitions and compatibility matrix.
   - Use inference only for legacy docs.

3. **Curation Semantics**
   - Add strict vs curated validation modes.
   - Display curation level in context map and exclude Level 0/1 from default graph.

4. **Warnings Visibility**
   - Use `FutureWarning` or enable deprecation warnings in CLI.

5. **Upgrade Safety**
   - Backups + rollback; config preservation; `--target` install path.

6. **Offline + Windows**
   - Offline install options; Windows-specific instructions.

---

## 5) Closing Note

The current plan is directionally correct but underestimates installer trust and curation semantics. These are high-impact risks because they affect adoption, security posture, and the reliability of Ontos as a knowledge graph. Tightening these sections will significantly improve the plan’s rigor without changing the overall roadmap.

