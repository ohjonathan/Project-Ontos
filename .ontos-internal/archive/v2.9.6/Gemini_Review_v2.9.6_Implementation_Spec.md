---
id: gemini_review_v2_9_6_spec
type: atom
status: complete
depends_on: [v2_9_6_implementation_specification]
concepts: [review, ontology, architecture]
---

# Technical Review: v2.9.6 Implementation Specification

**Reviewer:** Gemini CLI, powered by Gemini 2.0 Pro
**Date:** 2026-01-11
**Subject:** Ontology Architecture Implementation (v2.9.6)

---

## Verdict: NEEDS REVISION

The specification successfully identifies the core problem of fragmented ontology definitions but requires several adjustments to truly achieve its goal of a "Single Source of Truth" without introducing new technical debt or fragile import structures.

---

## Technical Issues

### 1. Duplicate Source of Truth for Event Types
The spec adds `event_type` valid values to `ontology.py` but fails to address the existing `EVENT_TYPES` dictionary in `ontos_config_defaults.py`, which contains rich metadata (definitions and examples).
- **Severity:** Medium
- **Impact:** Leaving two lists of event types will inevitably lead to drift.

### 2. Incomplete Config Migration
Section 2.7 specifies migrating `TYPE_DEFINITIONS` but omits `VALID_STATUS` and `STATUS_DEFINITIONS`.
- **Severity:** Low
- **Impact:** These are currently hardcoded in `ontos_config_defaults.py` and overlap with the new `FIELD_DEFINITIONS["status"]`. A partial migration leaves the project in an inconsistent state.

### 3. Import Path Fragility
`ontos_config_defaults.py` (located in `.ontos/scripts/`) importing `ontos.core.ontology` relies on the environment being a proper package.
- **Severity:** High
- **Impact:** Legacy scripts executing `ontos_config_defaults.py` directly (or importing it without a correctly configured `PYTHONPATH`) will break with `ModuleNotFoundError`. This is critical given Ontos's reliance on simple script execution.

### 4. `schema.py` Ambiguity
The spec declares `schema.py` "NOT Modified", yet the problem statement notes that rules are "scattered in code."
- **Severity:** Medium
- **Impact:** If `schema.py` contains hardcoded validation logic or field lists (which it likely does), leaving it untouched means `ontology.py` is only a documentation source, not an enforcement source. This violates the primary success criteria.

---

## Design Suggestions

### 1. Migrate Event Types Fully
Add an `EventTypeDefinition` dataclass to `ontology.py` to capture definitions and examples. Derive `EVENT_TYPES` and `VALID_EVENT_TYPES` in `ontos_config_defaults.py` from this dataclass.

### 2. Migrate Status Definitions
Add status descriptions to a `StatusDefinition` dataclass in `ontology.py`. Derive `VALID_STATUS` and `STATUS_DEFINITIONS` in `ontos_config_defaults.py` from this source.

### 3. Robust Import Handling
Add a `PYTHONPATH` shim or ensure the unified CLI (`ontos.py`) handles the path setup before any internal imports occur to prevent `ModuleNotFoundError` in legacy environments.

### 4. Refactor Schema Enforcement
Explicitly check `schema.py`. If it contains field lists or validation logic that overlaps with `ontology.py`, it must be refactored to consume the new definitions.

---

## Questions for Clarification

1.  **Enforcement:** Does `schema.py` currently contain hardcoded lists of fields? If so, why is it out of scope to refactor it to use the new single source?
2.  **Compatibility:** How will you ensure `ontos_config_defaults.py` remains functional for legacy scripts that are not package-aware?
3.  **Future-Proofing:** Is there a reason `STATUS_TRANSITIONS` was cut, given it is essential for the "Status Lifecycle" section of the generated documentation?

---
*Generated by Gemini CLI, powered by Gemini 2.0 Pro*
