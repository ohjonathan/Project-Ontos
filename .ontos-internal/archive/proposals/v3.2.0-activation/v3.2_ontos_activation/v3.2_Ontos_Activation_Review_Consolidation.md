# v3.2 Ontos Activation — Spec Review Consolidation

**Consolidation Date:** 2026-01-29  
**Input Reviews:** Gemini (Peer), Claude (Alignment), Codex (Adversarial)

---

## 1. Verdict Summary

| Reviewer | Role | Verdict | Blocking Issues |
|----------|------|---------|-----------------|
| Gemini | Peer | Approve with changes | 0 |
| Claude | Alignment | Request changes | 2 |
| Codex | Adversarial | Request changes | 1 |

**Consensus:** 0/3 Approve (all require changes)

**Overall Status:** Needs Targeted Revisions

---

## 2. The Killer Question

> **If tools don't automatically re-read AGENTS.md after compaction, does this proposal accomplish anything meaningful?**

| Reviewer | Position |
|----------|----------|
| Gemini | **Tiered map still valuable.** Auto-sync is secondary; the primary win is cheaper re-activation when users manually trigger it. |
| Claude | **Tiered map still valuable.** Even without auto-sync, Tier 1 (~2k tokens) reduces manual re-activation cost. Auto-sync specifically becomes useless if tools don't re-read. |
| Codex | **Likely no.** Reduces to "make `ontos map` output tiered" — adds format churn and maintenance risk without fixing the primary failure mode. |

**Consolidation Assessment:**  
**Not a fatal flaw, but proposal should be reframed.** The Tiered Context Map provides value independently of tool behavior. The proposal should be honest about this: the primary deliverable is **cheaper manual re-activation**, not automatic recovery. Auto-sync is a nice-to-have for tools that do re-read.

---

## 3. Blocking Issues

| # | Issue | Flagged By | Category | Impact | Suggested Fix |
|---|-------|------------|----------|--------|---------------|
| B1 | **"Active work detection" contradicts "no work-in-progress state" exclusion** | Claude (A-C1) | Scope Creep | Violates proposal's own stated boundary | Rename to "Recent Activity" throughout |
| B2 | **`ontos map` calling `ontos agents` violates single-responsibility** | Claude (A-C2) | Breaking Change | Breaks established command patterns | Keep commands separate; create `ontos activate` if unified workflow desired |
| B3 | **No automatic recovery if tools don't re-read instructions** | Codex (X-C1) | Philosophy Violation | Proposal fails main goal for many tools | Reframe: manual re-activation optimization, not automatic recovery |

---

## 4. Philosophy & Scope Concerns

The proposal's core claim is:
> Ontos manages **project context**, NOT **session context**.

| Concern | Raised By | Severity | CA Must Address |
|---------|-----------|----------|-----------------|
| "Active work detection" may be session context | Claude, Gemini | **Critical** | Yes |
| "Recent logs" tracking crosses the line | Codex | Medium | Yes |
| Git branch detection is session state | Gemini | Low | No (Gemini says data is project context) |
| `ontos map` with side effects violates least surprise | Gemini, Claude | **Major** | Yes |
| "Zero manual steps" contradicted by Q1 Option B | Claude | Major | Yes |

**Consolidation Assessment:**  
The proposal **partially honors its philosophy** but has mission creep in execution. The *data sources* (logs, status, git branch) are project context, but:
1. The terminology ("Active Work") implies session awareness
2. Coupling `map` and `agents` commands introduces surprising side effects
3. Success criteria conflict with recommendations

---

## 5. Open Question Recommendations

| Question | Gemini | Claude | Codex | Consolidated |
|----------|--------|--------|-------|--------------|
| **Q1: Auto-Sync Scope** | **B)** Only if exists | B implied | N/A | **B) Only sync if AGENTS.md exists** |
| **Q2: Tier 1 Token Budget** | **B)** ~2k | N/A | 2k may be too small for large repos | **B) ~2k, with overflow testing** |
| **Q3: Active Work Detection** | Modified D: logs + in_progress docs, **exclude uncommitted changes** | Rename to "Recent Activity" | Logs may mislead when stale | **D, minus uncommitted changes, renamed "Recent Activity"** |
| **Q4: CLAUDE.md Relationship** | **B)** Keep manual | B (keep manual) | N/A | **B) Keep manual** |

**Disagreements requiring CA decision:**
- Codex questions whether Tier 1 at 2k tokens scales to large repos (100k+ token projects). CA should clarify if dynamic sizing is needed.

---

## 6. Agreement Analysis

**Strong Agreement (All 3 reviewers):**

| Topic | Consensus Position |
|-------|-------------------|
| Tiered Context Map is valuable | Core improvement worth keeping |
| CLAUDE.md should remain manually maintained | Do not auto-sync user configs |
| "Uncommitted changes" is noisy/unreliable | Remove from active work detection |
| Auto-sync risks overwriting user customizations | Backup mechanism essential |

**Partial Agreement (2 of 3):**

| Topic | Majority Position | Dissent |
|-------|-------------------|---------|
| Proposal worth pursuing | Gemini, Claude: Yes with changes | Codex: Fragile, may not be worth complexity |
| Single-responsibility violation | Claude, Gemini: Yes, `map` shouldn't modify `agents` | Codex: Implicit (focused on tool behavior) |

**Disagreement (No consensus):**

| Topic | Gemini | Claude | Codex |
|-------|--------|--------|-------|
| Overall robustness | Good | Minor Deviations | Fragile |
| Core assumption validity | Acceptable limitation | Unverified but not fatal | Likely fatal flaw |

---

## 7. Edge Cases & Failure Modes

| Edge Case | Severity | Addressed in Spec? | Recommendation |
|-----------|----------|-------------------|----------------|
| User customizations overwritten by auto-sync | High | Partial (backup exists) | Add `# USER CUSTOM` section protection |
| Tiered map breaks downstream parsers/CI | High | No | Version the format; migration guide |
| Context map huge (100k+) — Tier 1 still 2k? | Medium | No | Dynamic tier sizing or explicit guidance |
| Multiple compactions in rapid succession | Medium | No | Debounce or warning fatigue mitigation |
| Tool compacts mid-command execution | Medium | No | Document as known limitation |
| `ontos map` performance degradation | Medium | No | Add performance benchmarks requirement |
| Race condition: two terminals run `map` simultaneously | Low | No | File locking or warning |

---

## 8. Required Actions for Chief Architect

**Priority 1 (Must address before proceeding):**

| # | Action | Addresses |
|---|--------|-----------|
| 1 | Rename "Active Work" to "Recent Activity" throughout | B1 |
| 2 | Decouple `map` and `agents` — either keep separate or create new `ontos activate` command | B2 |
| 3 | Reframe proposal: primary value is *manual re-activation optimization*, not automatic recovery | B3 |

**Priority 2 (Should address):**

| # | Action | Addresses |
|---|--------|-----------|
| 1 | Add `--no-sync` or `--sync-agents` flag for explicit control | Claude A-M4, Gemini P-M1 |
| 2 | Remove redundant staleness detection proposal (already in doctor.py:369) | Claude A-M2 |
| 3 | Reconcile success criteria #2 ("Zero manual steps") with Q1 Option B | Claude A-M3 |
| 4 | Add performance benchmarks requirement for `ontos map` | Gemini P-M2 |

**Priority 3 (Consider):**

| # | Action | Addresses |
|---|--------|-----------|
| 1 | Test tool re-read behavior (Claude/Cursor/Gemini/Codex) before implementation | Claude A-M1 |
| 2 | Protect user customizations with `# USER CUSTOM` section | Gemini P-m1 |
| 3 | Version the map format and provide migration guide | Codex X-H2 |

---

## 9. Decision Points for CA

1. **The Killer Question:** Is the proposal worth pursuing if tools don't re-read AGENTS.md?
   - **If yes:** Reframe value proposition around Tiered Context Map (cheaper manual re-activation)
   - **If no:** Rescope to Tiered Context Map only; remove auto-sync

2. **Philosophy Boundary:** Is "active work detection" project context or session context?
   - **If project context:** Rename to "Recent Activity" to avoid confusion
   - **If session context:** Remove it entirely

3. **Scope Creep:** Does `ontos map` doing auto-sync violate single-responsibility?
   - **If yes:** Split into separate commands; create `ontos activate` for unified workflow
   - **If no:** Justify why it belongs together; add explicit flag

4. **Success Criteria:** Can "Zero manual steps" coexist with "Only sync if exists" (Q1-B)?
   - **If yes:** Clarify how
   - **If no:** Remove or reword success criteria #2

---

## 10. Recommendation to Chief Architect

**Consolidation Verdict:** Approve with Required Changes

**Summary:**  
The **Tiered Context Map** is a high-value, low-risk improvement unanimously supported. The **AGENTS.md Auto-Sync** is more contentious — it violates single-responsibility and may provide limited value if tools don't re-read. The proposal should be reframed to emphasize manual re-activation optimization.

**The single most important thing the CA must address:**  
Decouple `map` and `agents` commands. Either keep them strictly separate or create a new `ontos activate` command as the unified entry point.

**Path Forward:**
- [ ] Address blocking issues B1–B3
- [ ] Make explicit decisions on philosophy questions (Section 9)
- [ ] Update proposal to v1.1
- [ ] Submit for verification review

---

## Consolidation Checklist

- [x] All Critical/Major issues from each review appear in Section 3
- [x] All open questions have consolidated recommendations
- [x] Disagreements between reviewers are explicitly flagged
- [x] Action items are specific and actionable
- [x] The "killer question" is directly addressed
- [x] Philosophy/scope concerns are clearly surfaced

---

**Consolidation signed by:**
- **Role:** Review Consolidator
- **Model:** Gemini 2.5 Pro, powered by Antigravity
- **Date:** 2026-01-29
- **Input Reviews:** Gemini (Peer), Claude (Alignment), Codex (Adversarial)
