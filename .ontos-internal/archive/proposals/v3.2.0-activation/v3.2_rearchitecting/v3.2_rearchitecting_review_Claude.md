Now let me look at the current state of the Ontos codebase to ground my review:Now I have enough context. Let me give you my thorough review.

---

## V3.2 Re-Architecture Support Proposal: Critical Review

### The Problem is Real, But the Solution Has Issues

The "decision amnesia" problem during migration is legitimate. You've lived it with finance-engine. But the proposed solution introduces complexity that conflicts with Ontos's core philosophy.

---

### Issue 1: Command Naming Collision is Worse Than Acknowledged

The proposal at 4.4 mentions the existing `export` command but hand-waves the resolution: "rename current to `export-claude` or deprecate."

From our past conversations, v3.0.5 was supposed to implement `ontos export --format=claude` for generating platform-specific instruction files. You also have `ontos agents` which already generates AGENTS.md and .cursorrules.

Now you're proposing a *third* meaning for "export": data extraction to JSON/YAML.

**The user confusion matrix:**
- `ontos agents` → generates AGENTS.md, .cursorrules
- `ontos export --format=claude` (planned v3.0.5) → generates CLAUDE.md
- `ontos export -o data.json` (this proposal) → extracts documents as JSON

These are three different things using overlapping terminology. This will confuse users and pollute your documentation.

**My recommendation:** Don't call this `export`. Call it `ontos extract` or `ontos dump` or `ontos snapshot`. Reserve `export` for the platform instruction files.

---

### Issue 2: Three Commands is Two Too Many

You justify three commands with "composability" and "separation of concerns." But your own workflow diagram shows:

```
2. Agent runs: ontos export --type strategy,product -o decisions.json
3. Agent runs: ontos decisions --migration-safe -o carry-forward.md
4. Agent runs: ontos migration-report
```

Why would anyone want just one of these in isolation during a migration? The use case is "I'm migrating, give me everything I need." Making users orchestrate three CLI calls adds ceremony without curation value.

**Counter-proposal:** One command with output modes:

```bash
# The common case - give me everything
ontos migrate -o ./migration/

# Just the data
ontos migrate --data-only -o snapshot.json

# Just the analysis
ontos migrate --analysis-only
```

This matches user intent. "Help me migrate" is one action, not three.

---

### Issue 3: Content Extraction Heuristics Won't Work in Practice

The `ontos decisions` command relies on finding headers like "## Decision", "## Rationale", "## Alternatives Rejected". But look at your finance-engine example—the decisions you describe are:

- "Use 4999 not None for UNCATEGORIZED" → In a *log*, probably in a paragraph
- "LLM malformed JSON → skip batch, don't crash" → Also a log entry

Logs don't have `## Decision` headers. They have dated entries with prose. The heuristics will miss most of your actual decisions.

Your mitigation is "add `decision_summary` field manually." But that defeats the value proposition. You're asking users to do the extraction work themselves via metadata, then claiming the tool "extracts" decisions.

**The deeper problem:** This feature requires structure that Ontos doesn't mandate. You either:
1. Add more ceremony (required decision headers) → contradicts philosophy
2. Build smarter extraction (LLM-powered?) → contradicts "deterministic validation"
3. Accept that extraction will be incomplete → then what's the point?

**My take:** Extraction is fundamentally an LLM-appropriate task. The *output schema* (your JSON format) is the value Ontos should provide. Let the AI agent do the extraction; Ontos provides the structure for the output.

---

### Issue 4: The Proposal Ignores Ontos's Primary Interface

Ontos is designed for AI agents. "Say 'Ontos' to activate." But this proposal is purely CLI-focused with no agent integration story.

How does an AI agent use these tools? The proposal imagines a developer running CLI commands, but that's not how Ontos works in practice. An agent should be able to:

1. User says: "We're migrating to TypeScript, help me figure out what survives"
2. Agent runs: `ontos migrate` (or uses MCP equivalent)
3. Agent reads the output and explains it to the user

The proposal doesn't cover:
- Agent-friendly output formats (the JSON schemas are good, but no agent workflow)
- How to add these to AGENTS.md instructions
- MCP compatibility (this is v4.0 scope, but worth mentioning)

---

### Issue 5: Scope Creep

Your roadmap shows:
- v3.1: Obsidian compatibility, native commands, token efficiency
- v3.2: Edge case fixes, improved validation

This proposal is not "edge case fixes." It's three new commands, new output schemas, content extraction logic, and potentially new frontmatter fields. That's v3.3 or v4.0 scope.

If you ship this as v3.2, your roadmap becomes meaningless.

---

### What the Proposal Gets Right

Before offering alternatives, credit where due:

1. **The migration classification logic is clever.** Safe/review/rewrite based on atom dependency analysis is a good use of the existing graph structure.

2. **The JSON schemas are well-designed.** Versioned, complete, sensible structure.

3. **The problem statement is clear.** You lived the pain; it comes through.

4. **Backward compatibility is preserved.** No breaking changes.

5. **Risks are honestly stated.** The "content extraction heuristics fail" risk is real and you acknowledge it.

---

### My Alternative Proposal

**Minimal viable version: One new command, one output**

```bash
ontos migrate
```

Generates `./migration/` with:

```
migration/
├── context_snapshot.json    # Full document data with dependency graph
├── analysis.md              # The dependency classification (safe/review/rewrite)
└── checklist.md             # Actionable migration steps
```

**Key differences from your proposal:**

1. **No decision extraction.** Let the AI agent read the snapshot and extract decisions. Ontos provides structure, not content analysis.

2. **Single command.** Migration is one intent, one action.

3. **Markdown primary, JSON secondary.** Matches Ontos philosophy. The analysis.md is for humans; the snapshot.json is for tools.

4. **No heuristics.** The classification (safe/review/rewrite) is deterministic based on type and dependency graph. That's the Ontos way.

5. **Defer decisions extraction.** If users want it, build it in v3.3 after you've seen how people actually use the basic migrate command.

---

### Answers to Your Open Questions

**1. Schema versioning:** Yes, include `$schema`. You already do this in the proposal. Good.

**2. Content extraction:** Skip it for v3.2. It's the weakest part of the proposal and the hardest to get right.

**3. Import capability:** Defer to v3.3. But design your export format with import in mind—include paths, IDs, everything needed to reconstruct.

**4. Atom classification:** Three levels (safe/review/rewrite) is fine. More nuance adds complexity without value.

**5. Log decision extraction:** Don't extract from logs automatically. Let the AI read them. If users want decisions in the export, they can add `decision_summary` to frontmatter. But don't pretend heuristics will work.

---

### Bottom Line

The problem is real. The migration classification logic is good. But three commands with content extraction heuristics is over-engineering that violates Ontos's "curation over ceremony" principle.

Ship one `ontos migrate` command that outputs the dependency graph with classifications. Let AI agents do the content analysis part—that's what they're good at. Ontos provides structure; LLMs provide comprehension.