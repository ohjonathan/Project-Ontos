Based on the CA Response and the corrected scope (Migration Support & Bulk Export), here is my peer review.

I have identified a **Major Architectural Risk** regarding the storage of migration status in file frontmatter, which could lead to version control conflicts in a team environment.

---

**v3.2_CA_Response_Review_Gemini.md**

# CA Response Review: Peer Reviewer (Gemini)

**Role:** Peer Reviewer (Gemini)
**Phase:** Pre-A â€” Response Review Round
**Version:** 3.2
**Subject:** Re-Architecture Support Proposal

## Your Role

**Fresh review:** I acknowledge the previous mismatch regarding the mental model. I have discarded the "Active Support Protocol" assumptions and am independently reviewing the revised "Migration Support & Data Export" proposal.

---

## Peer Review Template

### Command Structure UX

| Command | Clear Purpose? | Discoverable? | Notes |
| --- | --- | --- | --- |
| `ontos export data` | **Yes** | **Yes** | Clear primitive. Assumed to be the raw JSON/YAML dump. |
| `ontos export claude` | **Yes** | **Yes** | Purpose is clear (LLM Context), but architecturally brittle. (See UX Concerns). |
| `ontos migration-report` | **Yes** | **No** | "Report" implies a static artifact. Users may look for `ontos status`, `ontos check`, or `ontos dry-run`. |
| `ontos migrate` | **Yes** | **Yes** | Active verb. Implies state mutation. |

**UX Concerns:**

1. **Vendor Specificity (`export claude`):** While the "Convenience Alias" pattern justifies this for *now*, hardcoding a vendor name (`claude`) into the top-level CLI verbs is an anti-pattern. It couples the tool's identity to a specific model provider. If the team switches to OpenAI o3 or a local Llama model, this command becomes legacy debt.
2. **Destructive Action Anxiety:** `ontos migrate` is high-stakes. The UX must clearly distinguish between "generating the plan" (`migration-report`) and "executing the plan".

### Documentation Gaps

| Gap | Impact | Suggestion |
| --- | --- | --- |
| **Snapshot Schema** | Medium | If `export data` produces a shared snapshot primitive, its schema should be documented so users can write their own consumers (e.g., `export data |
| **Output Destinations** | Low | Clarify if `export claude` defaults to `stdout` (pipable) or a file. For Agentic workflows, piping is preferred. |

### Architecture Quality

**The CA decided on:**

* Shared snapshot primitive (internal)
* Optional frontmatter fields for decisions
* `migration_status` override field
* Convenience alias pattern

**Assessment:**
[ ] Sound architecture
[ ] Minor concerns
[x] **Significant concerns**

**Reasoning:**
While the **Shared Snapshot Primitive** is excellent (preventing state drift between human reports and LLM contexts), the decision to use **Frontmatter fields for `migration_status**` is dangerous in a distributed environment (see P-M1 below).

---

### Issues Found

**Major:**

| # | Issue | Section | Suggestion |
| --- | --- | --- | --- |
| **P-M1** | **Git Merge Conflicts via Frontmatter State** | Architecture | Storing mutable state (`migration_status`) in source-controlled file frontmatter is a risk. If two developers run migration checks on different branches, the `migration_status` line will change, causing merge conflicts on the Contract files themselves. **Suggestion:** Store migration state in an ephemeral `.ontos/` folder or git-ignored local state file, NOT in the domain files. |

**Minor:**

| # | Issue | Section | Suggestion |
| --- | --- | --- | --- |
| **P-m1** | **CLI Namespace Pollution** | Command Structure | `ontos export claude` promotes a vendor to a verb. Suggest demoting to `ontos export context --preset=claude` or similar, keeping `claude` as an alias/flag rather than a primary command. |
| **P-m2** | **Discoverability of Checks** | UX | Alias `ontos migration-report` to `ontos status` or `ontos check` to align with standard CLI conventions (e.g., `git status`, `kubectl auth can-i`). |

---

### Overall Assessment

**Proposal Status:**

[ ] Ready to proceed to spec
[x] **Needs revision**

**Final Remarks:**
The pivot to Migration/Export support is the right scope. The "Shared Snapshot" is the right architecture. However, **P-M1 must be addressed** before the spec is finalized. Writing automated tool status into human-maintained source files (Frontmatter) is a "Dual-Write" anti-pattern that will frustrate users with constant git noise. Move the status tracking to a sidecar file or ignored directory.