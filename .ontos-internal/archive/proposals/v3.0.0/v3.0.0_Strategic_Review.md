# Technical Co-Founder Strategic Review: Ontos v3.0.0

**Reviewer:** Claude Opus 4.5 (Technical Co-Founder)
**Date:** 2026-01-16
**Document Reviewed:** v3_0_2_Feature_Discussion.md
**Review Type:** Strategic Pre-Spec Review

---

## Executive Summary

After thorough codebase exploration, I have significant findings that challenge some assumptions in the Feature Discussion. The core direction is correct, but the problem diagnosis needs refinement and the priorities need adjustment.

**Key Finding:** The "archive exclusion" problem is misdiagnosed. The 34 validation errors aren't from archived documents being scanned - they're from **active documents referencing IDs that no longer exist**. This is a data quality issue, not a code bug.

**Strategic Verdict:** Proceed with v3.0.0, but with revised scope and priorities.

---

## Part 1: Problem Validation

### 1.1 "LLMs don't know what Ontos is" (Activation Problem)

**Claim:** When users say "Activate Ontos" to Claude Code, it fails because there's no CLAUDE.md.

**Codebase Evidence:**
- `.cursorrules` exists but uses **outdated v2.x paths** (`python3 .ontos/scripts/ontos_generate_context_map.py`)
- `CLAUDE.md` does NOT exist
- `AGENTS.md` does NOT exist
- `export.py` exists (93 lines) - generates basic CLAUDE.md template only

**Current .cursorrules content (outdated):**
```
When the user says "Ontos"...
1. Check/Run `python3 .ontos/scripts/ontos_generate_context_map.py`  # OLD PATH
2. Read Ontos_Context_Map.md
```

Should be: `ontos map`

**Verdict:** **REAL PROBLEM - CRITICAL**

The `.cursorrules` file is stale, referencing v2.x scripts. Even Cursor users get degraded experience. Claude Code, Codex, and Gemini CLI have zero support.

**Notes:** This is actually worse than stated. The existing Cursor support is broken because it points to deprecated scripts.

---

### 1.2 "Archive docs cause 39 validation errors" (Archive Noise)

**Claim:** `ontos doctor` reports errors from archived documents.

**Codebase Evidence:**

Running `ontos doctor` shows:
```
OK: configuration: .ontos.toml valid
WARN: git_hooks: Non-Ontos hooks: pre-push, pre-commit
OK: python_version: 3.9.6
OK: docs_directory: 5 documents in docs/
OK: context_map: Context map valid
OK: validation: No obvious issues
OK: cli_availability: ontos available

Health check: 6 passed, 0 failed, 1 warnings
```

The 34 validation issues appear in `Ontos_Context_Map.md` (Dependency Audit section), NOT in `ontos doctor` output.

**What the errors actually are:**
- 15 broken links from Phase 3/4 docs referencing archived `phase2_implementation_spec`
- 9 broken links from logs referencing non-existent atom docs (`cli`, `hook`, `export`)
- 6 depth warnings (dependency chains > 5)
- 2 architecture violations
- 2 lint warnings (invalid status values)

**Root Cause:** Active documents reference document IDs that were **archived without updating the references**. Archive exclusion IS working - the scanning correctly skips `archive/*`.

**Verdict:** **MISDIAGNOSED - Different Problem**

This isn't "archive exclusion fix" - it's **broken references in active documents**. The fix is either:
1. Update active docs to remove stale references (data cleanup)
2. Create stub docs for missing IDs (questionable)
3. Make validation tolerate missing depends_on targets (risky)

**Notes:** The Feature Discussion proposes a code fix for what is actually a data quality issue. The code is working correctly.

---

### 1.3 "13 CLI commands with poor discoverability" (CLI Docs)

**Claim:** Users don't know what commands do or when to use them.

**Codebase Evidence:**

CLI structure (`ontos/cli.py`):
- 12 subcommands registered (not 13): `init`, `map`, `log`, `doctor`, `export`, `hook`, `verify`, `query`, `migrate`, `consolidate`, `promote`, `scaffold`, `stub`

Help text quality varies:
- **Good:** `init`, `map`, `doctor`, `export` - clear descriptions
- **Minimal:** `verify`, `query`, `migrate`, `consolidate`, `promote`, `scaffold`, `stub` - wrapper commands with generic text

No examples in help output. No workflow guidance.

**Verdict:** **REAL PROBLEM - MODERATE**

Help text exists but is inconsistent. The bigger issue is 7 of 12 commands are thin wrappers to legacy scripts (`_scripts/`), creating architectural debt.

---

### 1.4 "Can't pip install ontos" (PyPI)

**Claim:** Package isn't on PyPI.

**Codebase Evidence:**

`pyproject.toml` is complete:
```toml
[project]
name = "ontos"
version = "3.0.1"
requires-python = ">=3.9"
dependencies = ["pyyaml>=6.0"]
[project.scripts]
ontos = "ontos.cli:main"
```

GitHub Actions CI exists (`.github/workflows/ci.yml`) - tests on Python 3.9-3.12.

**Missing for PyPI:**
- No publishing workflow
- No release automation
- Package name availability unknown

**Verdict:** **REAL PROBLEM - CRITICAL**

Ready to publish, just needs workflow and execution.

---

### 1.5 "Init behavior unclear when run twice" (Idempotency)

**Claim:** Running `ontos init` twice has undefined behavior.

**Codebase Evidence:**

`init.py` lines 40-42:
```python
if config_path.exists() and not options.force:
    return 1, "Already initialized. Use --force to reinitialize."
```

Behavior is **well-defined and safe**:
- Without `--force`: Exit 1 with clear message
- With `--force`: Overwrites config, reinstalls hooks
- Directory creation uses `exist_ok=True` (idempotent)
- Hook collision detection preserves non-Ontos hooks

**Verdict:** **NOT A PROBLEM - Already Handled**

Init IS idempotent (fails gracefully) and has `--force` for intentional reinitialization. The behavior is correct.

---

### 1.6 "Only 2 golden tests exist" (Test Coverage)

**Claim:** Output format changes could break workflows unnoticed.

**Codebase Evidence:**

Golden test infrastructure exists:
- `tests/golden/` directory with capture/compare scripts
- `tests/golden/baselines/{small,medium}/` with captured outputs
- Tests `ontos map` and `ontos log` commands
- Normalizes timestamps, paths, versions

Total test files: 30 (6,281 lines)
Coverage: CI runs on Python 3.9, 3.10, 3.11, 3.12

**Verdict:** **PARTIALLY OVERSTATED**

Golden test framework exists and is more mature than implied. Could expand to cover `ontos export` outputs. The "only 2 golden tests" refers to fixture sizes (small, medium), not test count.

---

## Part 2: Proposal Assessment

### 2.1 `ontos export` Command

**Proposal:** Generate platform-specific instruction files (CLAUDE.md, AGENTS.md, etc.)

| Aspect | Assessment |
|--------|------------|
| Feasibility | **Easy** |
| Complexity | 4-8 hours |
| Dependencies | None |
| Risk | Low |

**Implementation Considerations:**

Current `export.py` (93 lines) generates static CLAUDE.md template. Extension needed:

1. Add `--format` flag (claude/codex/gemini/cursor/all)
2. Add templates for each format
3. Include dynamic content (doc count, last updated, key commands)
4. Consider regenerating `.cursorrules` with correct v3.0 paths

**Template location:** `ontos/_templates/` exists but is minimal

**Critical insight:** `.cursorrules` needs updating regardless - it references deprecated v2.x scripts.

**Recommendation:** **Proceed as proposed, but also fix .cursorrules**

---

### 2.2 PyPI Publishing

**Proposal:** Set up GitHub Actions workflow for automated PyPI publishing.

| Aspect | Assessment |
|--------|------------|
| Feasibility | **Easy** |
| Complexity | 2-4 hours |
| Dependencies | PyPI account, package name |
| Risk | Low |

**Implementation Considerations:**

- pyproject.toml is complete and correct
- Add workflow: `.github/workflows/publish.yml`
- Use trusted publisher (OIDC) - no API tokens needed
- Trigger on version tags (`v*`)

**Package name:** "ontos" - need to verify availability on PyPI

**Recommendation:** **Proceed as proposed. TestPyPI first is wise.**

---

### 2.3 Archive Exclusion Fix

**Proposal:** Audit code paths to consistently exclude archive/ directories.

| Aspect | Assessment |
|--------|------------|
| Feasibility | N/A |
| Complexity | N/A |
| Dependencies | N/A |
| Risk | N/A |

**This is the wrong fix.**

The validation errors are from **active documents with broken references**, not from archived documents being scanned. The archive exclusion (`skip_patterns = ["archive/*"]`) IS working.

**What's actually needed:**
1. **Data cleanup:** Remove stale `depends_on` references in active docs
2. **OR graceful handling:** Validation could warn instead of error for missing deps
3. **OR documentation:** Explain that broken links from historical docs are expected

**Recommendation:** **Reconsider - This is a data quality issue, not a code bug**

---

### 2.4 CLI Documentation

**Proposal:** Improve --help output, create CLI reference, include in instruction files.

| Aspect | Assessment |
|--------|------------|
| Feasibility | **Easy** |
| Complexity | 4-6 hours |
| Dependencies | None |
| Risk | Low |

**Implementation Considerations:**

- 7 of 12 commands are wrappers to legacy scripts
- Help text defined in `cli.py` (lines 89-189)
- Could auto-generate from docstrings
- Including in instruction files is good

**Recommendation:** **Proceed, but deprioritize wrapper commands**

---

### 2.5 Golden Test Expansion

**Proposal:** Add golden tests for key command outputs.

| Aspect | Assessment |
|--------|------------|
| Feasibility | **Easy** |
| Complexity | 2-4 hours |
| Dependencies | None |
| Risk | Low |

**Implementation Considerations:**

Framework already exists. Need to:
1. Add `ontos export` output to golden tests
2. Add `ontos doctor` output
3. Update baselines when intentional changes made

**Recommendation:** **Proceed as proposed**

---

### 2.6 Init Idempotency

**Proposal:** Make `ontos init` safe to run multiple times.

| Aspect | Assessment |
|--------|------------|
| Feasibility | N/A |
| Complexity | N/A |
| Dependencies | N/A |
| Risk | N/A |

**Already implemented.** Init fails gracefully with clear message if already initialized. `--force` exists for intentional reinitialization.

**Recommendation:** **Drop from v3.0.0 scope**

---

## Part 3: Open Questions Resolution

### Feature 1: `ontos export`

**Q1.1: Should `ontos init` automatically generate all instruction files?**

**Recommendation:** **Hybrid - Generate AGENTS.md by default**

Reasoning:
- AGENTS.md is becoming the universal standard (Linux Foundation backing)
- Zero friction for new users
- `ontos export --format=claude` for specific platforms
- Init already suggests: "Tip: Run 'ontos export' for AI assistant integration"

**Q1.2: Should AGENTS.md be the default/universal format?**

**Recommendation:** **Yes**

Reasoning:
- AGENTS.md is supported by Codex, Jules, Aider, and emerging as standard
- Claude Code reads any .md file when explicitly loaded
- One file to maintain is better than four

**Q1.3: How should instruction files be kept updated?**

**Recommendation:** **Option C - Detect staleness and warn**

Reasoning:
- Auto-regenerate is too magical (surprise changes)
- Manual only leads to stale files
- Warning on `ontos doctor` or `ontos map` is right balance

---

### Feature 2: PyPI Publishing

**Q2.1: Is "ontos" available?**

**Recommendation:** Check immediately

Action: `pip index versions ontos` or check pypi.org/project/ontos

Alternatives if taken: `ontos-cli`, `project-ontos`

**Q2.2: TestPyPI first?**

**Recommendation:** **Yes**

Reasoning: Low cost, catches packaging issues, builds confidence

---

### Feature 3: Archive Exclusion

**Q3.1: Should archived documents ever be queryable?**

**Recommendation:** **Option B - Optional flag**

Reasoning:
- Archive should be ignored by default (noise reduction)
- `ontos query --include-archived` for historical research
- Separate index (Option C) is overengineering

---

### Feature 4: CLI Documentation

**Q4.1: Where should CLI reference live?**

**Recommendation:** **Combination - README section + instruction files**

Reasoning:
- README for discoverable quick reference
- Instruction files for LLM context
- Don't create separate docs that drift

**Q4.2: Should there be `ontos help <command>` alias?**

**Recommendation:** **No**

Reasoning:
- Standard is `<command> --help`
- Adding alias is unnecessary work
- Consistency with Python CLI conventions

---

### Feature 5: Golden Tests

**Q5.1: Is this P2 or should it be higher?**

**Recommendation:** **Keep P2**

Reasoning:
- Framework exists, this is incremental
- Not blocking activation problem
- Nice insurance, not critical path

**Q5.2: How to handle dynamic content?**

**Recommendation:** **Existing normalization approach**

The golden test framework already normalizes timestamps, paths, versions. Extend same pattern.

---

### Feature 6: Init Idempotency

**Q6.1: Is this a real problem?**

**Codebase Evidence:** Already handled. `init.py` lines 40-42 fail gracefully.

**Recommendation:** **Drop from v3.0.0 scope**

---

## Part 4: Priority Validation

### Current Proposal vs. My Recommendation

| Priority | Original | Recommended | Changes |
|----------|----------|-------------|---------|
| **P0** | `ontos export`, PyPI | `ontos export`, PyPI, **fix .cursorrules** | Added .cursorrules fix |
| **P1** | Archive fix, CLI docs | CLI docs only | **Removed archive fix** |
| **P2** | Golden tests, init idempotency | Golden tests only | **Removed init idempotency** |
| **Dropped** | - | Archive fix, init idempotency | Misdiagnosed/already done |

### Assessment Details

**P0: `ontos export`** - AGREE
- This is the core blocker
- Extend to support multiple formats
- Include dynamic project stats

**P0: PyPI Publishing** - AGREE
- Table stakes for adoption
- Metadata is ready

**NEW P0: Fix .cursorrules** - ADDED
- Current file references deprecated v2.x scripts
- Even existing Cursor users are broken
- Quick fix, high impact

**P1: CLI Docs** - AGREE
- Improves discoverability
- Can be done incrementally

**REMOVED: Archive Fix** - DISAGREE WITH ORIGINAL
- The code is working correctly
- The "errors" are data quality issues (stale references)
- Fix is documentation cleanup, not code change

**REMOVED: Init Idempotency** - DISAGREE WITH ORIGINAL
- Already implemented
- Fails gracefully with clear message
- `--force` exists

---

## Part 5: What's Missing?

### 5.1 Gaps in the Proposal

| Gap | Why It Matters | Recommendation |
|-----|----------------|----------------|
| **.cursorrules is stale** | Cursor users have broken activation | **Add to P0** |
| **Data cleanup for broken refs** | 34 validation warnings in context map | Document as known issue, fix in v3.0.3 |
| **No CONTRIBUTING.md** | Can't accept community contributions easily | Add to v3.1 scope |

### 5.2 Risks Not Addressed

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| "ontos" name taken on PyPI | Medium | High | Check NOW, have alternatives ready |
| AGENTS.md format changes | Low | Medium | Keep format simple, version it |
| LLMs don't read instruction files | Low | High | Test with Claude Code, Codex before release |

### 5.3 Dependencies Not Mentioned

| Dependency | Required By | Status |
|------------|-------------|--------|
| PyPI account | Publishing | Unknown - need to verify |
| GitHub secrets | Publishing workflow | Not configured |

### 5.4 Scope Concerns

**Is this too much for a point release?**

Original scope (6 features) was too ambitious for v3.0.0.

Recommended scope (3 features):
1. `ontos export` with multi-format support
2. PyPI publishing
3. .cursorrules update

This is right-sized. CLI docs and golden tests can slip to v3.0.3 if needed.

---

## Part 6: LLM Perspective (As a User of Ontos)

### 6.1 Activation Experience

**Question:** What signals help you understand how to work with an Ontos project?

**My Answer:**
1. **CLAUDE.md at root** - I check for this automatically
2. **Explicit declaration** - "This project uses Ontos" in an instruction file
3. **Context map path** - Knowing where to find `Ontos_Context_Map.md`
4. **Workflow expectations** - What to do at session start/end

Without an instruction file, I rely on README.md and try to infer from file structure.

---

### 6.2 Instruction File Content

**Question:** What information would be most useful?

**Suggested Template Structure:**
```markdown
# Project Documentation (AGENTS.md)

## Framework
This project uses **Ontos** for documentation management.

## Activation Protocol
When starting a session:
1. Run `ontos map` to ensure context map is current
2. Read `Ontos_Context_Map.md` for project structure
3. Load relevant documents based on user request

## Session End Protocol
Before ending: `ontos log -e "session-slug" --source "claude-code"`

## Quick Reference
- `ontos map` - Regenerate context map
- `ontos doctor` - Health check
- `ontos query <id>` - Find document by ID

## Project Stats
- Documents: 47 active
- Last updated: 2026-01-16
- Staleness warnings: 0
```

---

### 6.3 Error Handling

**Question:** When `ontos doctor` reports validation errors, how do you respond?

**My Answer:**
- **Errors I try to fix:** Missing required fields, broken frontmatter syntax
- **Errors I report:** Broken dependencies (need human decision)
- **Errors I ignore:** Depth warnings (informational)

Currently, the context map showing 34 issues would make me concerned and possibly try to "help" by fixing them - which could be counterproductive.

**Suggestion:** Distinguish between "errors" (must fix) and "warnings" (informational).

---

### 6.4 Command Discovery

**Question:** How do you learn what CLI commands are available?

**My Answer:**
1. Check instruction file first
2. Run `<tool> --help`
3. Look for README CLI section
4. Try common command names (`init`, `status`, `run`)

I rarely explore deeply - if the first few attempts fail, I ask the user.

---

### 6.5 Session Workflow

**Question:** Is "end session with `ontos log`" realistic? Would you remember?

**My Answer:**
Honestly, **no** - I would not reliably remember without:
1. Explicit reminder in instruction file
2. User asking me to archive
3. Hooks that prompt on certain actions

**Suggestions:**
- Pre-push hook could warn: "Uncommitted session? Run `ontos log`"
- `ontos doctor` could check for long sessions without logs
- Instruction file should emphasize this prominently

---

### 6.6 Format Preferences

**Question:** CLAUDE.md vs AGENTS.md vs GEMINI.md preference?

**My Answer:**
No functional difference in how I process them. I read markdown the same way regardless of filename.

**However:** Having a file specifically named `CLAUDE.md` signals "this is for Claude" which creates slight psychological anchoring. AGENTS.md as universal format makes sense.

---

## Part 7: Final Assessment

### 7.1 Strategic Verdict

**Are we solving the right problem?**
**Partially.** The activation problem is real and critical. The "archive exclusion" problem is misdiagnosed.

**Is v3.0.0 the right scope?**
**Too ambitious as proposed.** 6 features is too many. 3 focused features is right.

**Will this get us to product-market fit?**
**Partially.** v3.0.0 makes Ontos usable. Product-market fit requires user validation we don't have yet.

**Ready for spec phase?**
**Yes, with modifications.**

---

### 7.2 The Real Priorities

**If we could only ship ONE thing, what should it be?**

**The one thing:** `ontos export --all` that generates working instruction files

**Why:** Everything else (PyPI, CLI docs, tests) is friction reduction. But without instruction files, LLMs literally cannot discover Ontos exists in a project. This is the activation blocker.

**Minimum Viable v3.0.0:**
- [x] `ontos export` with AGENTS.md default + platform-specific options
- [x] PyPI publishing (makes installation work)
- [x] Fix .cursorrules to use v3.0 commands

**Nice to have (can slip to v3.0.3):**
- [ ] CLI documentation improvements
- [ ] Golden test expansion
- [ ] Data cleanup for broken references

---

### 7.3 Hard Questions for the Founder

Before proceeding, I need clarity on:

1. **Do we have a PyPI account?** Publishing is blocked without this.

2. **Are the 34 broken references acceptable?** They're in Phase 2/3/4 review docs - historical artifacts. Do we clean them up or document them as expected?

3. **Who is testing activation?** Before release, we need to verify that Claude Code, Codex CLI, and Gemini CLI actually read the instruction files and activate correctly.

---

### 7.4 What I'd Do Differently

1. **Start with AGENTS.md only** - Don't build 4 templates. Build one universal format, add platform-specific later if needed.

2. **Validate with real users** - Before v3.0.0, get 2-3 people to try installing and activating. The Feature Discussion is based on founder testing - we need external validation.

3. **Fix the data, not the code** - The 34 validation errors need documentation cleanup or explicit archival, not code changes to hide them.

---

### 7.5 Risks I'm Worried About

| Risk | Why It Concerns Me | How to Mitigate |
|------|-------------------|-----------------|
| PyPI name collision | "ontos" is a real word (Greek for "being") | Check availability TODAY |
| Instruction files not read | LLM CLIs may not auto-read AGENTS.md | Test with each platform before release |
| Scope creep | 6 features → 8 features → never ships | Hard commit to 3 features only |

---

### 7.6 Next Steps

If we proceed:

1. **Immediately:** Check PyPI name availability
2. **Before spec:** Decide on AGENTS.md vs multi-format strategy
3. **During implementation:** Test activation with Claude Code, Codex, Gemini CLI

---

## Recommended v3.0.0 Scope

### Prerequisites (Before Feature Work)
| Task | Effort | Notes |
|------|--------|-------|
| Clean up stale depends_on references | 1-2h | Fix 34 broken links in Phase 2/3/4 docs |

### Features
| Feature | Priority | Effort | Notes |
|---------|----------|--------|-------|
| `ontos export` with multi-format | P0 | 6-8h | AGENTS.md default |
| PyPI publishing workflow | P0 | 2-4h | Trusted publisher |
| Fix .cursorrules | P0 | 1h | Update to v3.0 paths |
| CLI help text improvements | P1 | 4h | If time permits |

**Total estimated effort:** 14-19 hours for P0 (incl. cleanup), +4 hours for P1

---

**Review signed by:**
- **Role:** Technical Co-Founder
- **Model:** Claude Opus 4.5
- **Date:** 2026-01-16
- **Review Type:** Strategic Review (Pre-Spec)

---

## Verification Plan

After implementation:

1. **Fresh machine test:** `pip install ontos && ontos init && ontos export --all`
2. **Claude Code test:** Open project, say "Activate Ontos", verify it works
3. **Codex CLI test:** Same activation test
4. **Golden tests:** Run full suite, update baselines if needed
5. **Manual smoke test:** Full workflow from init to log to map
